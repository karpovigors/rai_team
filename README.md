# Информационно-навигационная платформа для людей с нарушением слуха

## Описание системы

Это веб-приложение представляет собой информационно-навигационную платформу, специально разработанную для людей с нарушением слуха. Система предоставляет возможность находить доступные городские объекты, оценивать их по различным критериям доступности и делиться опытом через отзывы.

Основные возможности системы:
- Просмотр списка объектов с фильтрами
- Просмотр объектов на карте
- Переход в карточку объекта с подробной информацией
- Регистрация и вход в личный кабинет
- Редактирование профиля и аватара
- Подписка на push-уведомления
- Публикация отзывов

## Технологии

Проект состоит из двух основных частей:
- **Backend**: Django REST API
- **Frontend**: React/Vite с использованием TypeScript
- **База данных**: PostgreSQL
- **Хранилище файлов**: S3-совместимое хранилище (MinIO)
- **Оркестрация**: Docker Compose

## Установка и запуск

### Требования

- Docker Engine
- Docker Compose
- GNU Make

### Установка

1. Клонируйте репозиторий:
```bash
git clone https://github.com/karpovigors/rai_team.git
cd rai_team
```

2. Создайте файл `.env` на основе шаблона `.env.example`:
```bash
cp .env.example .env
```

3. Отредактируйте `.env` файл и укажите необходимые переменные окружения:
- `DB_NAME`, `DB_USER`, `DB_PASSWORD` - для подключения к PostgreSQL
- `S3_ACCESS_KEY`, `S3_SECRET_KEY` - для подключения к MinIO
- `DJANGO_SUPERUSER_USERNAME`, `DJANGO_SUPERUSER_PASSWORD` - для создания суперпользователя
- `VAPID_PUBLIC_KEY`, `VAPID_PRIVATE_KEY`, `VAPID_SUBJECT` - для push-уведомлений
- `VITE_YANDEX_GEOCODER_API_KEY` - для использования Яндекс.Карт

4. Запустите приложение с помощью Docker Compose:
```bash
make build
make up
```

Приложение будет доступно по адресу `http://localhost`

### Альтернативный запуск без Docker

Если вы хотите запустить приложение без Docker:

#### Backend:
```bash
cd backend
pip install -r requirements.txt
python manage.py migrate
python manage.py runserver
```

#### Frontend:
```bash
cd client
npm install
npm run dev
```

## Навигация по приложению

После запуска приложения вы можете получить доступ к следующим страницам:

- `/` - Главная страница со списком объектов
- `/building/:id` - Карточка конкретного объекта
- `/map_search` - Карта с объектами
- `/auth` - Страница авторизации
- `/register` - Страница регистрации
- `/profile` - Личный профиль пользователя

### Главная страница

На главной странице отображается список доступных объектов с возможностью:
- Поиска по названию
- Фильтрации по типу инфраструктуры
- Просмотра карточек объектов с основной информацией

### Карта

На странице карты отображаются метки всех объектов с возможностью:
- Просмотра информации о каждом объекте
- Перехода к построению маршрута в Яндекс.Картах
- Просмотра фотографий и краткого описания объекта

### Карточка объекта

Каждый объект имеет свою карточку, содержащую:
- Название и описание
- Адрес
- График работы
- Ближайшие станции метро
- Информацию о доступности (жестовый язык, субтитры, пандусы, Брайль)
- Отзывы пользователей

## Регистрация и авторизация

### Регистрация

Для регистрации нового пользователя:
1. Перейдите на страницу `/register`
2. Заполните форму регистрации:
   - Имя пользователя
   - Электронная почта
   - Пароль
   - Подтверждение пароля
3. Нажмите кнопку "Зарегистрироваться"

После успешной регистрации вы автоматически войдете в систему.

### Вход в систему

Для входа в систему:
1. Перейдите на страницу `/auth`
2. Введите свои учетные данные:
   - Имя пользователя
   - Пароль
3. Нажмите кнопку "Войти"

## Роли пользователей

Система поддерживает различные роли пользователей:

### Обычный пользователь
- Может просматривать объекты
- Может оставлять отзывы
- Может редактировать свой профиль
- Может подписываться на push-уведомления

### Модератор
- Все права обычного пользователя
- Может добавлять новые объекты
- Может редактировать существующие объекты
- Может удалять объекты
- Может удалять отзывы других пользователей
- Может отправлять тестовые push-уведомления

## Работа с профилем

В личном профиле пользователь может:
- Изменить имя пользователя
- Изменить электронную почту
- Сменить пароль
- Загрузить или удалить аватар
- Управлять push-уведомлениями

### Работа с аватаром

Система поддерживает загрузку и редактирование аватаров:
- Загрузка нового изображения
- Перетаскивание файла (drag-and-drop)
- Кадрирование изображения
- Удаление текущего аватара
- Редактирование уже установленного аватара

### Push-уведомления

Пользователи могут подписаться на различные типы уведомлений:
- Новые заведения
- Открытия маршрутов
- События
- Скидки
- Общие уведомления

Только модераторы могут отправлять тестовые уведомления другим пользователям.

## Специальные возможности интерфейса

Интерфейс приложения включает в себя панель специальных возможностей:
- Увеличение шрифта
- Высокий контраст
- Озвучивание текста (экранный диктор)

Эти функции помогают адаптировать работу приложения под индивидуальные потребности пользователей.

## Для разработчиков

### Структура проекта

```
rai_team/
├── backend/          # Django backend
│   ├── accounts/     # Модуль аутентификации
│   ├── core/         # Основная логика
│   └── rai_project/  # Настройки Django
├── client/           # React frontend
│   ├── src/
│   │   ├── components/    # Компоненты
│   │   ├── pages/         # Страницы приложения
│   │   ├── services/      # Сервисы (аутентификация, push-уведомления)
│   │   └── widgets/       # Виджеты
├── docker-compose.yml
├── Makefile
└── README.md
```

### Команды Make

Проект включает удобные команды для администрирования:

- `make build` - Сборка всех контейнеров
- `make up` - Запуск всех сервисов
- `make dev` - Запуск с логами
- `make down` - Остановка и удаление контейнеров
- `make logs` - Просмотр логов
- `make migrate` - Применение миграций
- `make test` - Запуск тестов
- `make db-backup` - Создание бэкапа БД
- `make clean` - Полная очистка

### Переменные окружения

Система использует следующие группы переменных окружения:

#### База данных
- `DB_NAME`
- `DB_USER`
- `DB_PASSWORD`
- `DB_HOST`
- `DB_PORT`

#### Django
- `DEBUG`
- `SECRET_KEY`
- `DJANGO_SUPERUSER_*`
- `MODERATOR_*`

#### S3/MinIO
- `S3_ACCESS_KEY`
- `S3_SECRET_KEY`
- `S3_BUCKET_NAME`
- `S3_ENDPOINT_URL`

#### Push-уведомления
- `VAPID_PUBLIC_KEY`
- `VAPID_PRIVATE_KEY`
- `VAPID_SUBJECT`

#### Карты
- `VITE_YANDEX_GEOCODER_API_KEY`
- `VITE_YANDEX_MAPS_API_KEY`

## Устранение неполадок

### Распространенные проблемы

1. **Не загружается карта**
   - Проверьте, что в системе корректно настроен ключ Яндекс.Карт

2. **Не работают push-уведомления**
   - Проверьте разрешение уведомлений в браузере

3. **Проблемы с авторизацией**
   - Проверьте настройки CORS в Django
   - Убедитесь, что сервер API доступен

4. **Не загружаются изображения**
   - Проверьте настройки S3/MinIO
   - Убедитесь, что бакет создан и доступен

### Общие шаги решения проблем

1. Обновите страницу в браузере
2. Проверьте интернет-соединение
3. Повторите вход в аккаунт
4. Проверьте логи контейнеров: `make logs`

## Лицензия

Проект распространяется под лицензией MIT.
